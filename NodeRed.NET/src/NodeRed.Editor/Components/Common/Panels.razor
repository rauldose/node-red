@* Source: @node-red/editor-client/src/js/ui/common/panels.js *@
@* Translated to Blazor for NodeRed.NET *@

<div class="red-ui-panels @(Horizontal ? "horizontal" : "vertical")">
    <div class="red-ui-panel panel-1" style="@GetPanel1Style()">
        @Panel1Content
    </div>
    <div class="red-ui-panels-separator" 
         @onmousedown="StartResize"
         @onmousedown:stopPropagation>
        <div class="separator-handle"></div>
    </div>
    <div class="red-ui-panel panel-2" style="@GetPanel2Style()">
        @Panel2Content
    </div>
</div>

@code {
    [Parameter] public RenderFragment? Panel1Content { get; set; }
    [Parameter] public RenderFragment? Panel2Content { get; set; }
    [Parameter] public bool Horizontal { get; set; } = false;
    [Parameter] public double InitialRatio { get; set; } = 0.5;
    [Parameter] public double MinSize { get; set; } = 100;
    [Parameter] public EventCallback<double> OnRatioChanged { get; set; }
    
    private double _ratio;
    private bool _isResizing;
    
    protected override void OnInitialized()
    {
        _ratio = InitialRatio;
    }
    
    private string GetPanel1Style()
    {
        if (Horizontal)
        {
            return $"width: calc({_ratio * 100}% - 3px);";
        }
        return $"height: calc({_ratio * 100}% - 3px);";
    }
    
    private string GetPanel2Style()
    {
        if (Horizontal)
        {
            return $"width: calc({(1 - _ratio) * 100}% - 3px);";
        }
        return $"height: calc({(1 - _ratio) * 100}% - 3px);";
    }
    
    private void StartResize()
    {
        _isResizing = true;
    }
    
    public void SetRatio(double ratio)
    {
        _ratio = Math.Max(0.1, Math.Min(0.9, ratio));
        StateHasChanged();
        OnRatioChanged.InvokeAsync(_ratio);
    }
}

<style>
    .red-ui-panels {
        display: flex;
        width: 100%;
        height: 100%;
    }
    .red-ui-panels.vertical {
        flex-direction: column;
    }
    .red-ui-panels.horizontal {
        flex-direction: row;
    }
    .red-ui-panel {
        overflow: auto;
    }
    .red-ui-panels-separator {
        flex-shrink: 0;
        display: flex;
        align-items: center;
        justify-content: center;
        cursor: ns-resize;
    }
    .red-ui-panels.horizontal .red-ui-panels-separator {
        cursor: ew-resize;
        width: 6px;
    }
    .red-ui-panels.vertical .red-ui-panels-separator {
        height: 6px;
    }
    .separator-handle {
        background-color: #ccc;
    }
    .red-ui-panels.horizontal .separator-handle {
        width: 2px;
        height: 30px;
    }
    .red-ui-panels.vertical .separator-handle {
        width: 30px;
        height: 2px;
    }
    .red-ui-panels-separator:hover .separator-handle {
        background-color: #888;
    }
</style>
